# googleMapLi
automatically recognizing a building's edge by its address Name.

# 方案：基于Nominatim项目实现
Nominatim是一种按名称和地址（地理编码）搜索 OpenStreetMap 数据并生成OSM点以及反向地理编码的工具。它用作OpenStreetMap主页上搜索框的检索任务。本项目是基于Nominatim的docker项目来实现，输入地址名称，返回建筑边缘经纬度。

## 部署Nominatim的docker项目
[Nominatim的docker项目](https://github.com/mediagis/nominatim-docker/tree/master/4.4)。具体的部署过程可以见下文所示。

### 下载包含所需地址的数据
在[下载地址](https://download.geofabrik.de/)，对所需要地址的地图pbf数据进行下载。保存于地址C:/Users/USTC/Desktop/Nominatim/data

### docker部署指令
```
docker run -e PBF_PATH=/nominatim/data/taiwan-latest.osm.pbf -p 8080:8080 -v C:/Users/USTC/Desktop/Nominatim/data:/nominatim/data --name nominatim mediagis/nominatim:4.4
```
其中，-e参数后接在镜像目录中地图数据所在的地址。-p参数为端口映射。-v参数表示目录的映射，格式为本机地图数据目录:镜像地图数据目录。--name参数可自动下载nominatim:4.4项目镜像。

该指令只需更改本机地图数据目录即可。同时，创建服务器的时间相当长，原因是：加载导入的地图数据，加载过程会比较耗时。
### 本地使用样例
搭建好了之后，在本机可以运行服务器，可在浏览器访问。更多使用方法的API请见[API](https://nominatim.org/release-docs/develop/api/Overview/)。

示例：
```
http://localhost:8080/search.php?q=清华大学&polygon_geojson=1&format=jsonv2
```
即可得到json格式的返回，其中geojson返回的建筑物轮廓经纬度
```
[
    {
        "place_id": 1609804,
        "licence": "Data © OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright",
        "osm_type": "relation",
        "osm_id": 3605515,
        "boundingbox": [
            "24.7849692",
            "24.7983978",
            "120.9871303",
            "121.0025382"
        ],
        "lat": "24.7916987",
        "lon": "120.99242952395865",
        "display_name": "國立清華大學, 101, 交清小徑, 光明里, 東區, 新竹市, 30013, 台湾",
        "place_rank": 30,
        "category": "amenity",
        "type": "university",
        "importance": 0.00000999999999995449,
        "geojson": {
            "type": "Polygon",
            "coordinates": [
                [
                    [
                        120.9871303,
                        24.7896431
                    ],
                    [
                        120.9877897,
                        24.7864404
                    ],
                    [
                        120.9881139,
                        24.7862477
                    ],
                    [
                        120.9900075,
                        24.7850751
                    ],
                    [
                        120.9902348,
                        24.7850037
                    ],
                    [
                        120.9904723,
                        24.7849692
                    ],
                    [
                        120.9907646,
                        24.784971
                    ],
                    [
                        120.9919325,
                        24.7849784
                    ],
                    [
                        120.9918738,
                        24.7863315
                    ],
                    [
                        120.9918864,
                        24.7871444
                    ],
                    [
                        120.9921309,
                        24.7876488
                    ],
                    [
                        120.9924319,
                        24.7881307
                    ],
                    [
                        120.9926886,
                        24.7886263
                    ],
                    [
                        120.99309,
                        24.789115
                    ],
                    [
                        120.9934074,
                        24.7892436
                    ],
                    [
                        120.9940429,
                        24.7895254
                    ],
                    [
                        120.9941813,
                        24.7896582
                    ],
                    [
                        120.9943829,
                        24.7897192
                    ],
                    [
                        120.9945521,
                        24.789799
                    ],
                    [
                        120.9946263,
                        24.789834
                    ],
                    [
                        120.9949042,
                        24.7903675
                    ],
                    [
                        120.9955233,
                        24.7906731
                    ],
                    [
                        120.9959893,
                        24.7906626
                    ],
                    [
                        120.9961851,
                        24.7908066
                    ],
                    [
                        120.9964169,
                        24.7907274
                    ],
                    [
                        120.9965798,
                        24.7910947
                    ],
                    [
                        120.9966566,
                        24.7911082
                    ],
                    [
                        120.9967965,
                        24.7910666
                    ],
                    [
                        120.9968878,
                        24.7910537
                    ],
                    [
                        120.9971641,
                        24.7909225
                    ],
                    [
                        120.9972902,
                        24.7907262
                    ],
                    [
                        120.9978314,
                        24.7903976
                    ],
                    [
                        120.997812,
                        24.7906501
                    ],
                    [
                        120.9977671,
                        24.7907801
                    ],
                    [
                        120.997733,
                        24.7908769
                    ],
                    [
                        120.9974586,
                        24.7911439
                    ],
                    [
                        120.9971873,
                        24.791439
                    ],
                    [
                        120.9971757,
                        24.7915584
                    ],
                    [
                        120.9970867,
                        24.7916814
                    ],
                    [
                        120.9969319,
                        24.7917271
                    ],
                    [
                        120.9968165,
                        24.791716
                    ],
                    [
                        120.9966107,
                        24.79172
                    ],
                    [
                        120.9957749,
                        24.791836
                    ],
                    [
                        120.9954281,
                        24.7919737
                    ],
                    [
                        120.9953182,
                        24.7919905
                    ],
                    [
                        120.9951183,
                        24.7925484
                    ],
                    [
                        120.9958523,
                        24.7931218
                    ],
                    [
                        120.9959832,
                        24.7930776
                    ],
                    [
                        120.9961055,
                        24.793023
                    ],
                    [
                        120.9962288,
                        24.7929861
                    ],
                    [
                        120.9963684,
                        24.7930339
                    ],
                    [
                        120.9965351,
                        24.7931634
                    ],
                    [
                        120.9966766,
                        24.7933247
                    ],
                    [
                        120.9967325,
                        24.7934887
                    ],
                    [
                        120.9967036,
                        24.7936663
                    ],
                    [
                        120.9966301,
                        24.7937982
                    ],
                    [
                        120.9967168,
                        24.7939346
                    ],
                    [
                        120.9964505,
                        24.7940842
                    ],
                    [
                        120.9973674,
                        24.7954834
                    ],
                    [
                        120.9974381,
                        24.795484
                    ],
                    [
                        120.9974678,
                        24.7954634
                    ],
                    [
                        120.997498,
                        24.7954384
                    ],
                    [
                        120.9982429,
                        24.7945685
                    ],
                    [
                        120.9989973,
                        24.7936882
                    ],
                    [
                        120.9994724,
                        24.7931216
                    ],
                    [
                        120.9999689,
                        24.7925515
                    ],
                    [
                        121.0003506,
                        24.7921687
                    ],
                    [
                        121.0006585,
                        24.7919426
                    ],
                    [
                        121.0012213,
                        24.7914357
                    ],
                    [
                        121.0025382,
                        24.7922568
                    ],
                    [
                        121.0011727,
                        24.7932257
                    ],
                    [
                        120.9993124,
                        24.7946078
                    ],
                    [
                        120.9978497,
                        24.7958592
                    ],
                    [
                        120.9976162,
                        24.7960817
                    ],
                    [
                        120.9971624,
                        24.796452
                    ],
                    [
                        120.9958025,
                        24.7974524
                    ],
                    [
                        120.9957232,
                        24.7975108
                    ],
                    [
                        120.9956854,
                        24.7975372
                    ],
                    [
                        120.9956354,
                        24.7975723
                    ],
                    [
                        120.9955536,
                        24.7975812
                    ],
                    [
                        120.9951746,
                        24.7970905
                    ],
                    [
                        120.9948108,
                        24.7969395
                    ],
                    [
                        120.9946212,
                        24.796936
                    ],
                    [
                        120.9941705,
                        24.7965886
                    ],
                    [
                        120.993426,
                        24.7956737
                    ],
                    [
                        120.9930156,
                        24.7959757
                    ],
                    [
                        120.9930967,
                        24.7961746
                    ],
                    [
                        120.9929245,
                        24.7964871
                    ],
                    [
                        120.9926028,
                        24.7968349
                    ],
                    [
                        120.9925511,
                        24.796872
                    ],
                    [
                        120.9924366,
                        24.796922
                    ],
                    [
                        120.9922987,
                        24.7970568
                    ],
                    [
                        120.9921912,
                        24.797253
                    ],
                    [
                        120.9922825,
                        24.7975034
                    ],
                    [
                        120.9922746,
                        24.7975566
                    ],
                    [
                        120.9922595,
                        24.7976536
                    ],
                    [
                        120.9922594,
                        24.7977483
                    ],
                    [
                        120.9922351,
                        24.7977782
                    ],
                    [
                        120.9921817,
                        24.7977542
                    ],
                    [
                        120.9920918,
                        24.7976962
                    ],
                    [
                        120.9919704,
                        24.7976612
                    ],
                    [
                        120.9917929,
                        24.7976272
                    ],
                    [
                        120.991703,
                        24.7976505
                    ],
                    [
                        120.9916602,
                        24.7977217
                    ],
                    [
                        120.9916467,
                        24.7978299
                    ],
                    [
                        120.9916249,
                        24.7979194
                    ],
                    [
                        120.9915648,
                        24.7979657
                    ],
                    [
                        120.9915023,
                        24.7980358
                    ],
                    [
                        120.9914009,
                        24.7981633
                    ],
                    [
                        120.9913252,
                        24.7982875
                    ],
                    [
                        120.991228,
                        24.7983721
                    ],
                    [
                        120.9911686,
                        24.7983978
                    ],
                    [
                        120.9911052,
                        24.7983854
                    ],
                    [
                        120.9910549,
                        24.7983532
                    ],
                    [
                        120.9910063,
                        24.7983033
                    ],
                    [
                        120.9909552,
                        24.7982354
                    ],
                    [
                        120.9908246,
                        24.7980618
                    ],
                    [
                        120.9907953,
                        24.7980161
                    ],
                    [
                        120.9906773,
                        24.7979888
                    ],
                    [
                        120.9905657,
                        24.7980052
                    ],
                    [
                        120.990489,
                        24.7980199
                    ],
                    [
                        120.9903829,
                        24.798067
                    ],
                    [
                        120.9902923,
                        24.7981503
                    ],
                    [
                        120.9902149,
                        24.7982469
                    ],
                    [
                        120.9901296,
                        24.7983132
                    ],
                    [
                        120.9900132,
                        24.7981221
                    ],
                    [
                        120.9899713,
                        24.7980579
                    ],
                    [
                        120.9899428,
                        24.798031
                    ],
                    [
                        120.9899019,
                        24.7980038
                    ],
                    [
                        120.9898389,
                        24.7979785
                    ],
                    [
                        120.9897072,
                        24.7976294
                    ],
                    [
                        120.9897058,
                        24.7975223
                    ],
                    [
                        120.9897186,
                        24.7972518
                    ],
                    [
                        120.9896173,
                        24.7969257
                    ],
                    [
                        120.9893955,
                        24.7966464
                    ],
                    [
                        120.9894842,
                        24.7958689
                    ],
                    [
                        120.9892389,
                        24.7947026
                    ],
                    [
                        120.9891476,
                        24.794167
                    ],
                    [
                        120.988491,
                        24.793867
                    ],
                    [
                        120.9884169,
                        24.7936786
                    ],
                    [
                        120.9884325,
                        24.7935602
                    ],
                    [
                        120.988657,
                        24.7933835
                    ],
                    [
                        120.9887132,
                        24.7933392
                    ],
                    [
                        120.988778,
                        24.7932427
                    ],
                    [
                        120.9888526,
                        24.7931315
                    ],
                    [
                        120.9888956,
                        24.7930674
                    ],
                    [
                        120.9888976,
                        24.7930181
                    ],
                    [
                        120.9889049,
                        24.7928388
                    ],
                    [
                        120.9888487,
                        24.7927948
                    ],
                    [
                        120.9887735,
                        24.7927359
                    ],
                    [
                        120.9887081,
                        24.7926846
                    ],
                    [
                        120.9886813,
                        24.7926135
                    ],
                    [
                        120.9886511,
                        24.7925332
                    ],
                    [
                        120.9886923,
                        24.7924516
                    ],
                    [
                        120.98874,
                        24.7923569
                    ],
                    [
                        120.9887868,
                        24.7922642
                    ],
                    [
                        120.9887982,
                        24.792077
                    ],
                    [
                        120.9887499,
                        24.7920552
                    ],
                    [
                        120.9887416,
                        24.792052
                    ],
                    [
                        120.9887372,
                        24.7920512
                    ],
                    [
                        120.9887351,
                        24.7920508
                    ],
                    [
                        120.9887313,
                        24.7920505
                    ],
                    [
                        120.98862,
                        24.7920131
                    ],
                    [
                        120.9885523,
                        24.7920215
                    ],
                    [
                        120.9884377,
                        24.7920357
                    ],
                    [
                        120.9883442,
                        24.7920626
                    ],
                    [
                        120.9881404,
                        24.7921213
                    ],
                    [
                        120.9881011,
                        24.7920657
                    ],
                    [
                        120.9880141,
                        24.7919426
                    ],
                    [
                        120.9879694,
                        24.7918795
                    ],
                    [
                        120.9878614,
                        24.791806
                    ],
                    [
                        120.9878244,
                        24.7917808
                    ],
                    [
                        120.9878324,
                        24.7916805
                    ],
                    [
                        120.9878446,
                        24.7915289
                    ],
                    [
                        120.9878575,
                        24.791367
                    ],
                    [
                        120.9876213,
                        24.7912043
                    ],
                    [
                        120.9874266,
                        24.7908723
                    ],
                    [
                        120.9872799,
                        24.7907282
                    ],
                    [
                        120.987266,
                        24.7903776
                    ],
                    [
                        120.9872651,
                        24.7902644
                    ],
                    [
                        120.9872642,
                        24.7901437
                    ],
                    [
                        120.987267,
                        24.7900845
                    ],
                    [
                        120.9872717,
                        24.7899823
                    ],
                    [
                        120.9872535,
                        24.7899327
                    ],
                    [
                        120.9872244,
                        24.7898533
                    ],
                    [
                        120.9871994,
                        24.7897975
                    ],
                    [
                        120.9871842,
                        24.7897636
                    ],
                    [
                        120.9871303,
                        24.7896431
                    ]
                ]
            ]
        }
    },
    {
        "place_id": 1608559,
        "licence": "Data © OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright",
        "osm_type": "node",
        "osm_id": 10024571349,
        "boundingbox": [
            "24.7931474",
            "24.7932474",
            "120.9932779",
            "120.9933779"
        ],
        "lat": "24.7931974",
        "lon": "120.9933279",
        "display_name": "清華大學(小吃部), 101, 齋群一路, 光明里, 東區, 新竹市, 30013, 台湾",
        "place_rank": 30,
        "category": "amenity",
        "type": "bicycle_rental",
        "importance": 0.00000999999999995449,
        "geojson": {
            "type": "Point",
            "coordinates": [
                120.9933279,
                24.7931974
            ]
        }
    },
    {
        "place_id": 1612932,
        "licence": "Data © OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright",
        "osm_type": "node",
        "osm_id": 10129850757,
        "boundingbox": [
            "24.796791",
            "24.796891",
            "120.99664",
            "120.99674"
        ],
        "lat": "24.796841",
        "lon": "120.99669",
        "display_name": "清華大學(北校門), 光復路二段, 光明里, 東區, 新竹市, 30070, 台湾",
        "place_rank": 30,
        "category": "amenity",
        "type": "bicycle_rental",
        "importance": 0.00000999999999995449,
        "geojson": {
            "type": "Point",
            "coordinates": [
                120.99669,
                24.796841
            ]
        }
    },
    {
        "place_id": 1638457,
        "licence": "Data © OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright",
        "osm_type": "node",
        "osm_id": 10024571379,
        "boundingbox": [
            "24.7953024",
            "24.7954024",
            "120.9923187",
            "120.9924187"
        ],
        "lat": "24.7953524",
        "lon": "120.9923687",
        "display_name": "清華大學(台達館), 101, 行勝路, 光明里, 東區, 新竹市, 30013, 台湾",
        "place_rank": 30,
        "category": "amenity",
        "type": "bicycle_rental",
        "importance": 0.00000999999999995449,
        "geojson": {
            "type": "Point",
            "coordinates": [
                120.9923687,
                24.7953524
            ]
        }
    },
    {
        "place_id": 1637056,
        "licence": "Data © OpenStreetMap contributors, ODbL 1.0. https://osm.org/copyright",
        "osm_type": "node",
        "osm_id": 4524886749,
        "boundingbox": [
            "24.7970216",
            "24.7971216",
            "120.9966591",
            "120.9967591"
        ],
        "lat": "24.7970716",
        "lon": "120.9967091",
        "display_name": "清華大學, 光復路二段, 軍功里, 東區, 新竹市, 30070, 台湾",
        "place_rank": 30,
        "category": "highway",
        "type": "bus_stop",
        "importance": 0.00000999999999995449,
        "geojson": {
            "type": "Point",
            "coordinates": [
                120.9967091,
                24.7970716
            ]
        }
    }
]
```